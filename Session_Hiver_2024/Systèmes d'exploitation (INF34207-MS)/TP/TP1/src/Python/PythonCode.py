from win32 import win32print


# 2.2 Présentez le code requis pour effectuer trois requêtes vers le système d’exploitation :

# Saisie d’une information (entrée de données au clavier)
def entering_information():
    age = input("Entrez votre âge : ")
    return age


# Affichage de l’information à l’écran
def display_information(age):
    print("Âge de l'utilisateur : ", age)


# Impression de la même information qu’à l’étape précédente, mais à partir d’une imprimante,
# donc, effectuer un appel à l’imprimante (par défaut)
def print_information(age):

    # -1- Trouver l'imprimante par défaut.
    printer_name = win32print.GetDefaultPrinter()
    
    # -2- Obtenir le handle d'imprimante pour effectuer les opérations d'imprimerie.
    printer_handle = win32print.OpenPrinter(printer_name)
    
    doc_info = ("Age_Utilisateur", None, "TEXT")
    
    # -3- Notifie le print spooler de notre document d'impression (gestionnaire de l'ordre des impressions). Crée une job d'impression.
    win32print.StartDocPrinter(printer_handle, 1, doc_info)

    # -4- Notifie le print spooler de notre page d'impression.
    win32print.StartPagePrinter(printer_handle)
    
    age_raw = age.encode("utf-8")
    
    # -5- Notifie le print spooler de nos données d'impression.
    win32print.WritePrinter(printer_handle, age_raw)
    
    # -6- Notifie le print spooler que l'application est à la fin de la page d'une impression.
    win32print.EndPagePrinter(printer_handle)
    
    # -7- Met fin à la job d'impression.
    win32print.EndDocPrinter(printer_handle)
    
    # -8- Ferme l'objet handle d'imprimante.
    win32print.ClosePrinter(printer_handle)


# Main
user_age = entering_information()
display_information(user_age)
print_information(user_age)
