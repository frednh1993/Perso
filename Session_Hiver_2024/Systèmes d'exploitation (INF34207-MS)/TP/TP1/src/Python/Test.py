import win32print
import win32ui
import win32con

def print_to_pdf(content, output_file):
    # Create a printer handle for the PDF printer
    printer_name = win32print.GetDefaultPrinter()
    printer_handle = win32print.OpenPrinter(printer_name)

    # Create a device context (DC)
    dc = win32ui.CreateDC()
    dc.CreatePrinterDC(printer_name)

    # Start a print job
    dc.StartDoc(output_file)
    dc.StartPage()

    # Set text options (optional)
    dc.SetMapMode(win32con.MM_TWIPS)
    dc.SetTextAlign(win32con.TA_LEFT | win32con.TA_TOP)

    # Print the content
    # text = content.decode("utf-8")  # Convert to bytes
    dc.TextOut(100, 100, content)

    # End the page and the print job
    dc.EndPage()
    dc.EndDoc()

    # Close the printer handle
    win32print.ClosePrinter(printer_handle)
    win32print.Pdf()

if __name__ == "__main__":
    content = "Hello, this is a test content for printing to PDF using Python and pywin32."
    output_file = "output.pdf"
    print_to_pdf(content, output_file)